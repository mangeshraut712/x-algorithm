<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X Algorithm Visualizer | Interactive Deep Dive</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="dark-mode">
    <div id="app">
        <header>
            <div class="logo-container">
                <svg class="x-logo" viewBox="0 0 24 24" aria-hidden="true"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
                <h1>Algorithm Visualizer</h1>
            </div>
            <nav>
                <button class="nav-btn active" data-view="pipeline">System Pipeline</button>
                <button class="nav-btn" data-view="model">Transformer Model</button>
                <button class="nav-btn" data-view="simulator">Feed Simulator</button>
            </nav>
        </header>

        <main>
            <!-- Pipeline View -->
            <section id="pipeline-view" class="view active">
                <div class="view-header">
                    <h2>Core Recommendation Pipeline</h2>
                    <p>How a post travels from the global corpus to your "For You" feed.</p>
                </div>
                
                <div class="pipeline-container">
                    <div class="pipeline-flow">
                        <div class="stage" id="stage-source">
                            <div class="stage-icon">üì•</div>
                            <h3>Candidate Sourcing</h3>
                            <div class="sub-stages">
                                <div class="sub-stage"><span>Thunder</span> (In-Network)</div>
                                <div class="sub-stage"><span>Phoenix</span> (Discovery)</div>
                            </div>
                        </div>
                        <div class="connector"></div>
                        <div class="stage" id="stage-hydration">
                            <div class="stage-icon">üíß</div>
                            <h3>Hydration</h3>
                            <p>Enriching items with author data, media, and social context.</p>
                        </div>
                        <div class="connector"></div>
                        <div class="stage" id="stage-filtering">
                            <div class="stage-icon">üõ°Ô∏è</div>
                            <h3>Filtering</h3>
                            <p>Removing duplicates, blocks, mutes, and unsafe content.</p>
                        </div>
                        <div class="connector"></div>
                        <div class="stage" id="stage-scoring">
                            <div class="stage-icon">‚ö°</div>
                            <h3>Scoring</h3>
                            <div class="sub-stages">
                                <div class="sub-stage">Phoenix Transformer</div>
                                <div class="sub-stage">Weighted Actions</div>
                            </div>
                        </div>
                        <div class="connector"></div>
                        <div class="stage" id="stage-selection">
                            <div class="stage-icon">‚úÖ</div>
                            <h3>Selection</h3>
                            <p>Final sorting and diversity adjustments.</p>
                        </div>
                    </div>
                </div>

                <div class="details-panel" id="stage-details">
                    <div class="placeholder-text">Click a stage above to see technical details from the codebase.</div>
                </div>
            </section>

            <!-- Model View -->
            <section id="model-view" class="view">
                <div class="view-header">
                    <h2>Phoenix Transformer</h2>
                    <p>The Grok-based engine that predicts your engagement.</p>
                </div>

                <div class="model-grid">
                    <div class="card isolation-card">
                        <h3>Candidate Isolation</h3>
                        <p>Unlike standard LLMs, the X algorithm uses "isolation masking" so candidates can't see each other.</p>
                        <div class="matrix-viz" id="attention-matrix">
                            <!-- Matrix generated by JS -->
                        </div>
                        <div class="viz-legend">
                            <span class="legend-item"><span class="box history"></span> User History</span>
                            <span class="legend-item"><span class="box cand"></span> Candidate</span>
                            <span class="legend-item"><span class="box mask"></span> Masked</span>
                        </div>
                    </div>

                    <div class="card actions-card">
                        <h3>Action Predictions</h3>
                        <p>The model predicts 15+ different actions simultaneously.</p>
                        <div class="actions-list" id="actions-viz">
                            <!-- Actions list -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Simulator View -->
            <section id="simulator-view" class="view">
                <div class="view-header">
                    <h2>Feed Simulator</h2>
                    <p>Experiment with ranking weights to see how the feed adapts.</p>
                </div>

                <div class="simulator-layout">
                    <div class="controls-panel">
                        <h3>Weight Customization</h3>
                        <div class="weight-sliders" id="weight-sliders">
                            <!-- Sliders generated by JS -->
                        </div>
                        <button class="reset-btn" id="reset-weights">Reset to Production Defaults</button>
                    </div>

                    <div class="feed-panel">
                        <h3>Predicted Feed</h3>
                        <div class="feed-items" id="mock-feed">
                            <!-- Feed items -->
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>Based on the open-sourced <code>x-algorithm</code> by xAI and X Corp.</p>
            <div class="footer-links">
                <a href="https://github.com/xai-org/x-algorithm" target="_blank">View Repository</a>
            </div>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
